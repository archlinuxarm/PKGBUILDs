# Maintainer: Ian Botley <ianjb@plugapps.com>

# This package is meant for people who want to build ipkg packages
# for OpenPogo or those who run kernel 2.6.22.18, not necessarily
# for all Pogoplug users.

pkgname=kernel-headers-pogo
pkgver=2.6.22.18
_basever=2.6.22
pkgrel=3
pkgdesc="Kernel headers for the Linux kernel version 2.6.22.18"
arch=('arm')
conflicts=('kernel-headers')
provides=('kernel-headers')
license=('GPL')
url="http://www.gnu.org/software/libc"

source=(ftp://ftp.kernel.org/pub/linux/kernel/v2.6/linux-${_basever}.tar.bz2
        http://www.kernel.org/pub/linux/kernel/v2.6/patch-${pkgver}.bz2)
md5sums=('2e230d005c002fb3d38a3ca07c0200d0'
         '639fe3f8e676a349ba74c5405f09dd99')

build() {
  cd ${startdir}/src/linux-${_basever}
  patch -Np1 -i ${startdir}/src/patch-${pkgver} || return 1
  sed -i 's/getline/parseline/g' ${startdir}/src/linux-${_basever}/scripts/unifdef.c

  make mrproper
  make headers_check || return 1
  make INSTALL_HDR_PATH=${startdir}/pkg/usr headers_install
}
