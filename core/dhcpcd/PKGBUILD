# Maintainer: Ronald van Haren <ronald.archlinux.org>
# Contributor: Tom Killian <tom.archlinux.org>
# Contributor: Judd Vinet <jvinet.zeroflux.org>
# Modified by OpenPogo

pkgname=dhcpcd
pkgver=5.0.4
pkgrel=1
pkgdesc="RFC2131 compliant DHCP client daemon"
url="http://roy.marples.name/dhcpcd/"
arch=(arm)
license=('BSD')
#groups=('base')
depends=()
backup=('opt/etc/conf.d/dhcpcd' 'opt/etc/dhcpcd.conf')
options=('emptydirs')
source=("http://roy.marples.name/downloads/$pkgname/$pkgname-$pkgver.tar.bz2" \
        'dhcpcd.conf.d'
	'Makefile')
md5sums=('0b920a8094ee3a8c16c973794561feef'
         '372d33485556982b64a97f301e17c5dd'
	 'cc4f85ea0a4a59444c511d383792c813')

build() {
  cd ${srcdir}/${pkgname}-${pkgver}

  # Build
  rm Makefile
  cp $srcdir/Makefile .
  make || return 1
  make DESTDIR=${pkgdir} install || return 1

  # Create Binary Symlink
  install -d ${pkgdir}/opt/sbin || return 1

  # Install Configuration File used in /etc/rc.d/network
  install -D -m644 ../dhcpcd.conf.d $pkgdir/opt/etc/conf.d/$pkgname || return 1

  # Install License
  install -d $pkgdir/opt/share/licenses/$pkgname || return 1
  awk '{if(FNR<27)print $0}' ${srcdir}/${pkgname}-${pkgver}/config.h \
	>> ${pkgdir}/opt/share/licenses/${pkgname}/LICENSE || return 1

  # Make Man Pages FHS Compliant
#  mv -f ${pkgdir}/opt/man ${pkgdir}/opt/share/man || return 1

  # Set Options in /opt/etc/dhcpcd.conf
  echo noipv4ll >> ${pkgdir}/opt/etc/dhcpcd.conf || return 1
}
