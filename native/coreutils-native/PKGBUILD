# Maintainer: Alexander Foremny <alexanderforemny@gmail.com>

pkgname=coreutils-native
pkgver=8.5
pkgrel=2
pkgdesc="The basic file, shell and text manipulation utilities of the GNU operating system"
arch=(i686 x86_64)
license=(GPL3)
url="http://www.gnu.org/software/coreutils"
groups=(arm-crossdev)
depends=('glibc-native>=2.9-7' 'shadow-native>=4.1.3.1-1' 'pam-native>=1.0.4' 'acl-native>=2.2.47' 'gmp-native>=4.2.4' 'libcap-native')
options=('!emptydirs')
source=(ftp://ftp.gnu.org/gnu/coreutils/coreutils-$pkgver.tar.gz su)
md5sums=('c1ffe586d001e87d66cd80c4536ee823'
         'fa85e5cce5d723275b14365ba71a8aad')

_PREFIX=/usr/arm-softfloat-linux-gnueabi
_LIBDIR=/usr/lib/$CARCH
_LINKER=$_LIBDIR/ld-linux.so.2

build() {
  cd $srcdir/coreutils-$pkgver

  ./configure --prefix=$_PREFIX || return 1
  make LDFLAGS="-Wl,-dynamic-linker,$_LINKER" || return 1
  make DESTDIR=$pkgdir install || return 1

  ln -sf "$_PREFIX/bin/test" "$pkgdir$_PREFIX/bin/["

  install -m644 $srcdir/su $pkgdir$_PREFIX/bin
  chmod 4555 $pkgdir$_PREFIX/bin/su

  for dir in man info; do
    rm -rf $pkgdir$_PREFIX/share/$dir
  done
}

# vim: set ft=sh sw=2 ts=2 et:
