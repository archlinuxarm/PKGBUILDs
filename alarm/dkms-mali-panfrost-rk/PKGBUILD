# Mali driver for mainline linux on rk platforms
# Maintainer: Marty E. Plummer <hanetzer (at) startmail (dot) com>

buildarch=4

_gitname="linux-panfrost"
pkgname=dkms-mali-panfrost-rk
pkgver=r6p1
pkgrel=2
pkgdesc="Mali Panfrost Kernel Module for rockchipdrm"
arch=('armv7h')
url="https://gitlab.freedesktop.org/panfrost/${_gitname}"
license=('MIT')
install="$pkgname".install
depends=('linux>=4.12' 'linux-headers>=4.12' 'dkms')
makedepends=('git')
provides=('dkms-mali')
conflicts=('dkms-mali')
options=(!strip)
source=("git+${url}.git" "dkms.conf")
md5sums=('SKIP'
         '6a00ebba0fbd3e391962d76a0a6ded09')

package() {
	cp dkms.conf "$srcdir/$_gitname/"
	cd "$srcdir/$_gitname/"
	mkdir -p "$pkgdir/usr/src/mali-panfrost-rk-${pkgver}"
	cp -r . "$pkgdir/usr/src/mali-panfrost-rk-${pkgver}"
}
