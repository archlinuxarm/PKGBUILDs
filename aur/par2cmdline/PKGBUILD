# Maintainer: BlackEagle < ike DOT devolder AT gmail DOT com >

plugrel=1

pkgname=par2cmdline
pkgver=0.4
pkgrel=18
pkgdesc="Providing a tool to apply the data-recovery capability concepts of RAID-like systems to the posting & recovery of multi-part archives on Usenet."
url="http://sourceforge.net/projects/parchive/"
license="GPL"
depends=('gcc-libs')
makedepends=()
arch=('i686' 'x86_64')
source=(
	"http://downloads.sourceforge.net/sourceforge/parchive/${pkgname}-${pkgver}.tar.gz"
	"01-Use-_stati64-under-WIN32-to-get-file-size.patch"
	"02-Report-empty-files-when-verifying.patch"
	"03-Correct-error-in-Par2CreatorSourceFile-UpdateHashes-.patch"
	"04-offset-must-always-be-updated-even-when-progress-is-.patch"
	"05-When-a-file-is-specified-to-be-scanned-but-it-dooen-.patch"
	"06-Introduced-conditional-compilation-to-speed-up-thing.patch"
	"07-Optimization-by-inlining.patch"
	"08-Allowing-commandline-passing-of-files.patch"
	"09-Fixing-processing-of-the-first-file-parameter-the-ou.patch"
	"10-Pack-and-simplify-MD5Hash.patch"
	"11-Use-autogenerated-methods-in-letype.patch"
	"12-Fix-headers-in-par2cmdline.h.patch"
	"13-hardlinks.patch"
	"14-fixes-stupid-warnings.patch"
)
sha256sums=(
	'9e32b7dbcf7bca8249f98824757d4868714156fe2276516504cd26f736e9f677'
	'ece2cacec41d820d697e8fb5838b39e5ea1be1ced2a4cbe93d739a05a94db33a'
	'd4976200ea20b44d0efbc8225ed510157a59b921b710a9cf353052df8f7d2175'
	'1024c6dbfc7b8993a683c28a91d156552190ae33c925b217864ea874c8135eeb'
	'f6e6c1bb8fbc6eb40947dbc9f14fcf4856de840fa970d3482900408d9aaa2f43'
	'00efeff75f8a8cf61d47763b9a86ba92c68a7201d1ec50915830802b08f466e2'
	'a472bc0321cde509d0bfe1d0887a3209ba4997673d7e5a49c31cf225546da802'
	'ff9aba8c2b5e5050f811e11331637241db2fed48c2bbf5a34c970b70d45b6179'
	'3076b42f152c447a24f119b5586ef702a994efa6f4fbb3a3a51d1122effef435'
	'4e5c70345b1bd40019c58c0f334a76d9ece5bbb3cd08e1fb1a16b614c8e2e0cb'
	'4f562411d3d431af99560789cfd69f4d6c72ca82986d4999f8ab7e6c0db7f912'
	'3b7c0644143b6498ca21cb6b892b645346092f79aa5d0bc0e56fbd6181eb2e31'
	'13ce51e827cd6c959a6cd92322e79df26e59f4177d831530239be491b8ffc9ff'
	'a1f6f551acf5d05f2173d6ac328a30044f2af2f2f15e87547e69fad5250a2653'
	'0c2413f0d1c024127063b5cbb0a403fe12555ec820190f7981db4a5a82be7b62'
)

build() {
	cd ${pkgname}-${pkgver}
	for patch in ${startdir}/[0-9][0-9]*.patch; do
		msg ${patch}
		patch -Np1 -i ${patch}
	done
	msg "remove old files"
	rm -f Makefile.in \
		aclocal.m4 \
		config.guess \
		config.h.in \
		config.sub \
		configure \
		depcomp \
		install-sh \
		missing \
		mkinstalldirs
	msg "run autotools stuff"
	aclocal --force
	autoconf --force
	autoheader --force
	automake --foreign --add-missing --copy --force-missing
	msg "Configure"
	./configure --prefix=/usr
	msg "Make"
	make
}

package() {
	cd ${pkgname}-${pkgver}
	make DESTDIR=$startdir/pkg install
}
