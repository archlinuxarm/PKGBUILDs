# Maintainer: <n17ikh@gmail.com>
# Contributor: <igor.mogielnicki@gmail.com>

pkgname=mhddfs
pkgver=0.1.39
pkgrel=1
pkgdesc="fuse filesystem that combines several mount points into a single one."
arch=('i686' 'x86_64')
url="http://mhddfs.uvw.ru/"
license=('GPL3')
depends=('fuse')
makedepends=('uthash')
source=(http://mhddfs.uvw.ru/downloads/${pkgname}_${pkgver}.tar.gz pthreads.patch)
md5sums=('efc43fa9b4c1437bb233149bd624a459'
         'd6476ffcc21897748014815c824652f7')

build() {
  cd "$srcdir/${pkgname}-${pkgver}"
  patch -p0 < ${srcdir}/pthreads.patch
  make

  mkdir -p $pkgdir/usr/bin \
    $pkgdir/usr/share/doc/$pkgname \
    $pkgdir/usr/share/man/man1

  cp "$srcdir/${pkgname}-${pkgver}/mhddfs" "$pkgdir/usr/bin"

  cp $srcdir/${pkgname}-${pkgver}/COPYING \
    $srcdir/${pkgname}-${pkgver}/LICENSE \
    $srcdir/${pkgname}-${pkgver}/README \
    $srcdir/${pkgname}-${pkgver}/README.ru.UTF-8 \
    $srcdir/${pkgname}-${pkgver}/ChangeLog \
    $pkgdir/usr/share/doc/$pkgname

  gzip -c $srcdir/${pkgname}-${pkgver}/mhddfs.1 > $pkgdir/usr/share/man/man1/mhddfs.1.gz
}
