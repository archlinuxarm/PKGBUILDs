# Maintainer: Stefan Husmann <stefan-husmann@t-online.de>
# Contributor: Angel 'angvp' Velasquez <angvp[at]archlinux.com.ve>
# Contributor: Douglas Soares de Andrade <dsandrade@gmail.com>

pkgname=tora
pkgver=2.0.0
pkgrel=3
pkgdesc="Toolkit for databases with support for MySQL and PostgreSQL"
arch=('i686' 'x86_64')
url="http://tora.sourceforge.net"
license=('GPL')
depends=('qt' 'qscintilla')
options=('!libtool' '!emptydirs')
source=(http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz \
  toqvalue.sprintf.patch)
md5sums=('e90e0d3dbec98e89e9c292d603318003' 'd208a2224dd907300ef716e845ae9f37')
install=tora.install

build() {
  cd $srcdir/$pkgname-$pkgver
  ./configure --prefix=/usr --without-oracle --with-x \
    --with-qt-dir=/usr/share/qt --libdir=/usr/lib || return 1
  patch -p1 < $srcdir/toqvalue.sprintf.patch || return 1
  pushd src
  for _i in moc*.cpp
  do
    sed -i 's+ 59+ 61+' ${_i}
  done
  popd
  make || return 1
  make DESTDIR="$pkgdir" install || return 1
  rm $pkgdir/usr/share/info/dir || return 1
  gzip $pkgdir/usr/share/info/* || return 1
}
