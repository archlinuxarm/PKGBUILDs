# Maintainer: Kessia 'even' Pinheiro <kessiapinheiro at gmail.com> 
# Contributor: kastor <kastor@fobos.org.ar>
pkgname=ushare
pkgver=1.1a
pkgrel=5
pkgdesc="A free UPnP A/V Media Server for Linux"
url="http://ushare.geexbox.org"
license=('GPL2')
arch=('i686' 'x86_64')
depends=('libupnp' 'libdlna')
backup=(etc/ushare/ushare.conf)
source=("http://ushare.geexbox.org/releases/${pkgname}-${pkgver}.tar.bz2" 
        "ushare")
md5sums=('5bbcdbf1ff85a9710fa3d4e82ccaa251' 
         'a439fdc3b869cc03c2fc83cc452eedd9')

build() {
  cd ${srcdir}/${pkgname}-${pkgver}
  sed -i -e \
    "s%^INSTALL=\"/usr/bin/install -c\"$%INSTALL=\"$(which install) -c\"%" \
    configure || return 1
  ./configure --prefix=/usr --sysconfdir=/etc/${pkgname} \
    --enable-dlna --with-libdlna-dir=/usr/include/libavformat || return 1

  make || return 1
  make DESTDIR=${pkgdir} install || return 1
  
  rm -rf ${pkgdir}/etc/${pkgname}/init.d || return 1
  install -m 0755 -D ${srcdir}/ushare ${pkgdir}/etc/rc.d/ushare || return 1
  install -d -m 0755 ${pkgdir}/etc/${pkgname}/conf.d/ || return 1
  echo "PARAMS=" > ${pkgdir}/etc/${pkgname}/conf.d/ushare || return 1
}
