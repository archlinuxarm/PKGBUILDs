# $Id: PKGBUILD 3634 2009-10-06 20:19:55Z spupykin $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor:  3ED <kas1987@o2.pl>

pkgname=mcabber
pkgver=0.9.10
pkgrel=1
pkgdesc="is a small Jabber console client, includes features: SSL, PGP, MUC, UTF8"
arch=('i686' 'x86_64')
url="http://www.lilotux.net/~mikael/mcabber/"
license=('GPL')
depends=('ncurses' 'glib2' 'openssl' 'gpgme' 'libotr' 'aspell')
makedepends=('pkgconfig')
source=(http://www.lilotux.net/~mikael/mcabber/files/$pkgname-$pkgver.tar.bz2)
md5sums=('887415d16c32af58eab2ec2d9bb17fa6')

build() {
  cd $startdir/src/$pkgname-$pkgver

patch -p2 <<EOF
--- src/mcabber-0.9.7/src/screen.h~	2008-05-03 16:03:02.000000000 +0200
+++ src/mcabber-0.9.7/src/screen.h	2008-05-03 16:03:12.000000000 +0200
@@ -5,7 +5,7 @@
 
 #if HAVE_NCURSESW_NCURSES_H
 # include <ncursesw/ncurses.h>
-# include <ncursesw/panel.h>
+# include <panel.h>
 #elif HAVE_NCURSES_NCURSES_H
 # include <ncurses/ncurses.h>
 # include <ncurses/panel.h>
EOF

  ./configure --prefix=/usr --enable-hgcset --with-ssl \
      --with-openssl=/usr/lib --mandir=/usr/share/man \
      --enable-aspell --enable-otr
  make || return 1
  make DESTDIR=$startdir/pkg install || return 1
  mkdir -p $startdir/pkg/usr/share/mcabber/example
  msg "Copying mcabberrc.example to usr/share/mcabber/example/mcabberrc"
  cp -a $startdir/src/$pkgname-$pkgver/mcabberrc.example \
  	$startdir/pkg/usr/share/mcabber/example/mcabberrc
}
