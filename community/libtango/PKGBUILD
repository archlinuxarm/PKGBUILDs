# $Id: PKGBUILD 82 2009-07-17 19:56:55Z aaron $
# Maintainer: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Anders Bergh <anders1@gmail.com>

pkgname=libtango
pkgver=0.99.8
pkgrel=1
pkgdesc="Runtime library for the D programming language"
arch=('i686')
url="http://dsource.org/projects/tango"
source=(http://downloads.dsource.org/projects/tango/$pkgver/tango-$pkgver-src.tar.gz
        dmd.conf)
md5sums=('23b27e069c73f2d101fd3ed83978abe6'
         'b16c7f8eeb3adebe805ca03a4b183efc')
depends=('dmd')
license=('custom')
conflicts=('libphobos')
backup=('etc/dmd.conf')
options=('!makeflags')

build() {
  cd $srcdir/tango-$pkgver-src

  cd lib
  export MAKEFLAGS=-j1
  ./build-dmd.sh || return 1
  ./build-tango.sh dmd || return 1

  install -d $pkgdir/usr/lib
  install -d $pkgdir/usr/include{,/d}
  cp -f $srcdir/tango-$pkgver-src/lib/libtango-base-dmd.a $pkgdir/usr/lib || return 1
  cp -f $srcdir/tango-$pkgver-src/lib/libtango-user-dmd.a $pkgdir/usr/lib || return 1
  cp -f $srcdir/tango-$pkgver-src/object.di $pkgdir/usr/include/d || return 1
  cp -Rf $srcdir/tango-$pkgver-src/tango $pkgdir/usr/include/d || return 1
  cp -Rf $srcdir/tango-$pkgver-src/std $pkgdir/usr/include/d || return 1

  install -d $pkgdir/etc
  cp $srcdir/dmd.conf $pkgdir/etc || return 1

  install -Dm644 $srcdir/tango-$pkgver-src/LICENSE $pkgdir/usr/share/licenses/$pkgname/LICENSE
}
