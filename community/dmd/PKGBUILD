# $Id: PKGBUILD 1902 2009-09-05 21:36:48Z cbrannon $
# Maintainer: Chris Brannon <cmbrannon79@gmail.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Anders Bergh <anders1@gmail.com>
# Contributor: Alexander Fehr <pizzapunk gmail com>

pkgname=dmd
pkgver=1.047
pkgrel=1
pkgdesc="The Digital Mars D compiler."
arch=('i686')
url="http://www.digitalmars.com/d/1.0/"
source=(http://ftp.digitalmars.com/$pkgname.$pkgver.zip)
md5sums=('218c386c1d9363071b971614a988150d')
provides=('d-compiler')
license=('custom')
options=('!strip')
depends=()
optdepends=('libphobos: D standard runtime library'
            'libtango: Alternative runtime library')

build() {
  # Copy the license.
  install -Dm644 $srcdir/dmd/license.txt $pkgdir/usr/share/licenses/dmd/LICENSE || return 1

  install -Dm755 $srcdir/dmd/linux/bin/dmd $pkgdir/usr/bin/dmd || return 1
  install -Dm755 $srcdir/dmd/linux/bin/dumpobj $pkgdir/usr/bin/dumpobj || return 1
  install -Dm755 $srcdir/dmd/linux/bin/obj2asm $pkgdir/usr/bin/obj2asm || return 1
  install -Dm755 $srcdir/dmd/linux/bin/rdmd $pkgdir/usr/bin/rdmd || return 1

  for x in $srcdir/dmd/man/man1/*.1; do
    install -Dm644 $x "$pkgdir/usr/share/man/man1/$(basename $x)"
  done

  for x in $srcdir/dmd/man/man1/*.5; do
    install -Dm644 $x "$pkgdir/usr/share/man/man5/$(basename $x)"
  done
}
