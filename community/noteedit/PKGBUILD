# $Id: PKGBUILD 82 2009-07-17 19:56:55Z aaron $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Wael Nasreddine <gandalf@siemens-mobiles.org>

pkgname=noteedit
pkgver=2.8.1
pkgrel=3
pkgdesc="NoteEdit is a free music score editor for Linux."
arch=('i686' 'x86_64')
depends=('tse3' 'kdelibs3' 'fam' 'timidity++')
install=noteedit.install
license=('GPL')
url="http://noteedit.berlios.de/"
options=('!libtool' '!strip')
source=(http://download.berlios.de/$pkgname/$pkgname-$pkgver.tar.gz \
	http://ftp.de.debian.org/debian/pool/main/n/noteedit/noteedit_2.8.1-2.2.diff.gz)
md5sums=('653985c131afce45f0aa401fe4930909'
         'fe547a43d745c917925026ad9c50741e')

#
# Remove KDE4 before building or patch PKGBUILD/noteedit build
# because it mess kde3 and kde4 libs.
#
build() {
  cd $startdir/src/$pkgname-$pkgver

  patch -Np1 <../noteedit_2.8.1-2.2.diff

  export PATH=/opt/kde/bin/:$PATH
  ./configure --prefix=/opt/kde --enable-debug --without-arts
  sed -i 's#noteedit_LDFLAGS = $(KDE_RPATH)#noteedit_LDFLAGS = $(KDE_RPATH) -L/opt/kde/lib -lkparts#' noteedit/Makefile
  make || return 1
  make DESTDIR=$startdir/pkg install
}
