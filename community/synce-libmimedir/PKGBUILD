# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Zhukov Pavel <gelios@gmail.com>

# ALARM: Kevin Mihelich <kevin@archlinuxarm.org>
#  - staticlibs option
#  - build with -fPIC for armv7h and aarch64

pkgname=synce-libmimedir
pkgver=0.4
pkgrel=8
pkgdesc="provide a means of communication with a Windows CE device - library that parses MIME Directory Profile."
arch=('i686' 'x86_64')
url="http://synce.sourceforge.net/"
license=('GPL')
options=('staticlibs')
source=(http://downloads.sourceforge.net/sourceforge/synce/libmimedir-$pkgver.tar.gz)
md5sums=('156e1eb69377d9ae9180a09e38148ec6')

build() {
  cd $srcdir/libmimedir-$pkgver
  if [ "$CARCH" = "x86_64" -o "$CARCH" = "armv7h" -o "$CARCH" = "aarch64" ]; then
      sed -i -e 's|Wall|Wall -fPIC -DPIC|g' Makefile.in
      ./configure --prefix=/usr --disable-shared --with-pic
    else  ./configure --prefix=/usr --disable-shared
  fi
  make
}

package() {
  cd $srcdir/libmimedir-$pkgver
  mkdir -p $pkgdir/usr/{include,lib}
  make prefix=$pkgdir/usr install
}
