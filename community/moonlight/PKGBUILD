# Maintainer: Timm Preetz <timm@preetz.us>
# Contributor: Daniel Isenmann <daniel @ archlinux.org>
pkgname=moonlight
pkgver=1.0.1
pkgrel=5
pkgdesc="An open source implementation of Microsoft's Silverlight"
arch=('i686' 'x86_64')
license=('LGPL')
depends=('gtk2' 'ffmpeg')
makedepends=('pkgconfig' 'nspr' 'libxtst' 'imagemagick' 'alsa-lib' 'xulrunner')
url="http://www.mono-project.com/Moonlight"
source=("http://ftp.novell.com/pub/mono/sources/moon/moon-${pkgver}.tar.bz2")
options=('!libtool')
md5sums=('48fafb26a48f15c30fd2d52b2add5660')

build() {
	export MONO_SHARED_DIR=${startdir}/src/weird
	mkdir -p "${MONO_SHARED_DIR}"
	cd ${startdir}/src/moon-${pkgver}/

	./configure --with-ffmpeg=yes --with-cairo=system --with-alsa=yes \
		--with-debug=no --prefix=/usr --with-ff3=yes 
	make || return 1
	make DESTDIR=${startdir}/pkg/ install || return 1
	
	mkdir -p ${pkgdir}/usr/lib/mozilla/plugins/
	install -m755 ${startdir}/pkg/usr/lib/moon/plugin/*.so ${startdir}/pkg/usr/lib/mozilla/plugins || return 1
}
