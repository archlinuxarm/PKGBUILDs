# $Id: PKGBUILD 3228 2009-10-01 09:19:45Z spupykin $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Tom Newsom <Jeepster@gmx.co.uk>
# Maintainer: damir <damir@archlinux.org>

#
# FIXME:
# Don't know how to make this build system search in /usr/include/gtk-2.0
# I just make symlinks to gtk, gdk, gdk-pixbuf
#

pkgname=gpsdrive
pkgver=2.10pre7
pkgrel=5
pkgdesc="A car (bike, ship, plane) navigation system"
arch=(i686 x86_64)
depends=('gtk2' 'libgda3' 'gpsd' 'perl-file-slurp' 'perl-www-mechanize' 'perl-text-query'
	 'perl-dbi' 'perl-xml-twig' 'perl-date-manip')
url="http://www.gpsdrive.de/"
license=('GPL')
options=('!makeflags')
install=gpsdrive.install
source=(http://www.gpsdrive.de/packages/$pkgname-$pkgver.tar.gz)
md5sums=('dd5e1382bae11a5514e4fd6853eb062e')

build() {
  cd $srcdir
  rm -rf build
  mkdir build

  sed -i 's#option(WITH_MAPNIK "Build with mapnik support" ON)#option(WITH_MAPNIK "Build with mapnik support" OFF)#' gpsdrive-$pkgver/DefineOptions.cmake
  sed -i 's#option(WITH_SPEECH "Build with support of speech output" ON)#option(WITH_SPEECH "Build with support of speech output" OFF)#' gpsdrive-$pkgver/DefineOptions.cmake

  cd build
  cmake -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=/usr $srcdir/gpsdrive-$pkgver
  make || return 1
  make DESTDIR=$pkgdir install
}
