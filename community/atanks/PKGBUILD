# $Id: PKGBUILD 3538 2009-10-05 09:31:17Z spupykin $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Jacek Poplawski <jacekpoplawski@gmail.com> 
# Contributor: Charlie Cox <ccoxiv@yahoo.com>

pkgname=atanks
pkgver=4.0
pkgrel=1
pkgdesc="Atomic Tanks"
url="http://atanks.sourceforge.net"
license=('GPL')
arch=('i686' 'x86_64')
makedepends=('sed')
depends=('allegro' 'gcc-libs')
source=(http://downloads.sourceforge.net/project/atanks/atanks/atanks-$pkgver/atanks-$pkgver.tar.gz)
md5sums=('21627f3e8329f125dc99b12ae46ab74e')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  rm src/Makefile.system
  cp src/Makefile src/Makefile.system

  sed -i 's/^FLAGS += -DDATA_DIR=\\\".\\\"/FLAGS += -DDATA_DIR=\\\"${INSTALLDIR}\\\"/'  src/Makefile.system

  make system || return 1
  make PREFIX=${pkgdir}/usr/ INSTALL="install -c" install || return 1

  sed -i 's/^Name=atanks/Name=Atomic Tanks/' atanks.desktop
  sed -i 's/^Categories=Game;/Categories=Game;StrategyGame;/' atanks.desktop

  install -Dm644 atanks.desktop $pkgdir/usr/share/applications/atanks.desktop || return 1
  install -Dm644 atanks.png $pkgdir/usr/share/pixmaps/atanks.png || return 1
}
