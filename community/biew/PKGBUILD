# $Id: PKGBUILD 2895 2009-09-22 17:25:41Z spupykin $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=biew
pkgver=6.0.0
_lver=600
pkgrel=1
pkgdesc="Binary viewer"
arch=(i686 x86_64)
license=('GPL')
depends=(slang gpm)
url="http://biew.sourceforge.net/"
options=(zipman)
source=(http://downloads.sourceforge.net/project/biew/biew/$pkgver/biew-${_lver}-src.tar.bz2)
md5sums=('1bb12fe473befb92f4d616b0a92731f6')

build() {
  cd $startdir/src/${pkgname}-${_lver}
  ./configure --prefix=/usr
  make || return 1

  sed -i "s|PREFIX=/usr|PREFIX=$startdir/pkg/usr|" config.mak
  sed -i "s|DATADIR=/usr/share/biew|DATADIR=$startdir/pkg/usr/share/biew|" config.mak
  sed -i "s|LIBDIR=/usr/lib/biew|LIBDIR=$startdir/pkg/usr/lib/biew|" config.mak

  patch makefile <<EOF
266,267c266,266
< 	\$(INSTALL) -D -c -m 644 bin_rc/xlt/* \$(DATADIR)/xlt
< 	\$(INSTALL) -D -c -m 644 bin_rc/xlt/russian/* \$(DATADIR)/xlt/russian
---
> 	cp -r bin_rc/xlt/* \${DATADIR}/xlt
EOF

  make prefix=$startdir/pkg/usr install || return 1

  mv $pkgdir/usr/man $pkgdir/usr/share/
}
