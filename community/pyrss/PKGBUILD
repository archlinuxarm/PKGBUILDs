# $Id: PKGBUILD 82 2009-07-17 19:56:55Z aaron $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=pyrss
pkgver=0.9.9.1
pkgrel=2
pkgdesc="jabber rss transport"
arch=(i686 x86_64)
url="http://code.google.com/p/pyrss/"
license=("GPL")
depends=(python python-pyxmpp python-feedparser mysql-python)
backup=(etc/ejabberd/pyrss.xml)
source=(http://archlinux-stuff.googlecode.com/files/pyrss-$pkgver.tar.bz2 \
        pyrss.rc)
md5sums=('3f48f3b7f36c2c588b8d55a5841482ab' '75be6610f4c1fdb51e52b2d503fbf81b')

build() {
    cd $startdir/src
    install -d -m0755 $startdir/pkg/usr/lib
    cp -r $pkgname-$pkgver $startdir/pkg/usr/lib
    mv $startdir/pkg/usr/lib/$pkgname-$pkgver $startdir/pkg/usr/lib/$pkgname

    install -d -m0755 $startdir/pkg/etc/ejabberd
    mv $startdir/pkg/usr/lib/$pkgname/pyrss.xml $startdir/pkg/etc/ejabberd/pyrss.xml
    install -D -m0755 pyrss.rc $startdir/pkg/etc/rc.d/pyrss
    sed -i 's#/etc/jabber/pyrss.xml#/etc/ejabberd/pyrss.xml#' $startdir/pkg/usr/lib/$pkgname/contrib/auth.py
    sed -i 's#/etc/jabber/pyrss.xml#/etc/ejabberd/pyrss.xml#' $startdir/pkg/usr/lib/$pkgname/pyrss.py
}
