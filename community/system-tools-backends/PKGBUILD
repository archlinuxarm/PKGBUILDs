# Maintainer : Biru Ionut <ionut@archlinux.ro>
# Contributor: Hugo Doria <hugo@archlinux.org>

pkgname=system-tools-backends
pkgver=2.6.1
pkgrel=2
pkgdesc="backends for Gnome System Tools"
arch=('i686' 'x86_64')
url="http://system-tools-backends.freedesktop.org/"
license=('GPL')
depends=('perl' 'perl-xml-twig' 'dbus>=1.1.2' 'policykit')
makedepends=('perlxml' 'perl-xml-twig' 'pkgconfig' 'intltool')
source=(http://system-tools-backends.freedesktop.org/downloads/2.6/${pkgname}-${pkgver}.tar.gz stbd
	system-tools-backends.conf.patch)
install=system-tools-backends.install
md5sums=('e4c7aa86bd8a48b7f9e9ba1676574ebb'
         'ea449d7591f8a86a49ed3570b544e802'
	 '4baa1cb7cb1f45e0c9cb4991ac24ef9d')
build() {
	cd ${srcdir}/${pkgname}-${pkgver}
	patch -Np1 -i ${srcdir}/system-tools-backends.conf.patch || return 1

	./configure --prefix=/usr --with-dbus-sys=/etc/dbus-1/system.d \
		  --localstatedir=/var
      	make || return 1
      	make DESTDIR=${pkgdir} install|| return 1

      	install -D -m755 ../stbd ${pkgdir}/etc/rc.d/stbd

	#clean up man because of crappy build
	rm -rf ${pkgdir}/usr/share/system-tools-backends-2.0/modules/share
}
