# $Id: PKGBUILD 82 2009-07-17 19:56:55Z aaron $
# Maintainer: Eric Belanger <belanger@astro.umontreal.ca>

pkgname=musepack-tools
pkgver=1.15v
pkgrel=1
pkgdesc="Musepack decoder/encoder"
arch=(i686 x86_64)
url="http://www.musepack.net/"
license=("LGPL")
depends=('esd')
source=(http://files2.musepack.net/source/mpcsv7-src-$pkgver.tar.bz2)
md5sums=('eb3e6b64b1f7d68aaeb04e39936d87fb')

build() {
  cd $startdir/src/sv7
  sed -i 's/void       OverdriveReport/static void       OverdriveReport/' mppdec.h
  sed -i 's|#define USE_IRIX_AUDIO|//#define USE_IRIX_AUDIO|' mpp.h
  sed -i 's|OverdriveReport|//OverdriveReport|' mppdec.c
	if [ $CARCH == x86_64 ] ; then
	sed -re 's|i586|x86-64|' -i $startdir/src/sv7/Makefile
	sed -re 's|i686|x86-64|' -i $startdir/src/sv7/Makefile
	fi
  make LDADD="-lm -lesd"  all mppdec || return 1
  install -D -m755 mppdec $startdir/pkg/usr/bin/mppdec
  install -D -m755 mppenc $startdir/pkg/usr/bin/mppenc
  install -D -m755 replaygain $startdir/pkg/usr/bin/replaygain
}
