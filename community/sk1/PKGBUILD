# $Id: PKGBUILD 82 2009-07-17 19:56:55Z aaron $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: ConnorBehan <connor.behan@gmail.com>

pkgname=sk1
pkgver=0.9.1
pkgrel=1
pkgdesc="Fork of skencil with improved CMYK support"
arch=(i686 x86_64)
url="http://sk1project.org/modules.php?name=Products&product=sk1"
depends=('tcl>=7.6' 'tk>=4.2' 'python-lcms' 'pil>=1.0' 'pyxml' 'zenity')
license=('GPL' 'LGPL')
source=(http://sk1project.org/downloads/sk1/$pkgver\pre_rev730/sk1-$pkgver\pre_rev730.tar.gz \
	dialog.patch \
	sk1.desktop)
md5sums=('723dbc0ef9b5426a8e9d4b132421c838'
         '38b53bf8a02fcdc82577ca63f04a1555'
         'bbf6f10b8155838eede93b5abed724f5')

build() {
  local _tclver=`pacman -Q tcl`
  local _tclnum=${tclver:4:3}
  local _tcldir='tcl'${tclnum}

  cd $srcdir/sK1-${pkgver}pre
  python setup.py install --prefix=/usr --root=$pkgdir || return 1

  mkdir -p $pkgdir/usr/share/pixmaps && \
  mkdir -p $pkgdir/usr/share/applications || return 1

  cp $pkgdir/usr/lib/python2.6/site-packages/sk1/share/icons/CrystalSVG/icon_sk1_32.png \
   $pkgdir/usr/share/pixmaps/sk1.png || return 1

  cp $srcdir/sk1.desktop $pkgdir/usr/share/applications || return 1

  mkdir $pkgdir/usr/lib/${_tcldir} && \
  cp -r $pkgdir/usr/lib/python2.6/site-packages/sk1/share/ttk-themes/Plastik \
    $pkgdir/usr/lib/${_tcldir}/Plastik || return 1

#  patch -p0 $pkgdir/usr/lib/python2.6/site-packages/sk1/app/conf/configurator.py <$srcdir/dialog.patch
}
