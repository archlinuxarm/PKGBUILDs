# $Id: PKGBUILD 1496 2009-08-24 19:09:44Z mherych $
# Maintainer: Mateusz Herych <heniekk@gmail.com>
# Contributor: Filippo 'JoeyrS' Civiletti <joeyrs@gmail.com>

pkgname=armagetronad
pkgver=0.2.8.2.1
pkgrel=1
pkgdesc="A Tron Clone in 3D."
arch=('i686' 'x86_64')
url="http://armagetronad.net/"
license=('GPL')
depends=('sdl_image' 'libxml2' 'sdl_mixer' 'mesa' 'ftgl')
source=(http://downloads.sourceforge.net/sourceforge/armagetronad/armagetronad-$pkgver.src.tar.gz
	armagetronad.desktop
	gcc43.patch)
md5sums=('be4ee66a499a8fe7122391e8340cb576'
         '29d1b1231acadff12cf3014a3867ba5c'
	 '9045d99559ef33fc18136630e8de916c')

build()	{
	 cd $startdir/src/armagetronad-$pkgver
	 sed -i 's|FTGL.h|ftgl.h|g' configure
	 patch -p1 < ../gcc43.patch
	 ./configure --prefix=/usr \
	 	--sysconfdir=/etc/ \
		--mandir=/usr/share/man \
	       	--disable-games \
		--enable-automakedefaults
	 make || return 1
	 make DESTDIR=$startdir/pkg install
	 install -D -m 644 $startdir/armagetronad.desktop $startdir/pkg/usr/share/applications/armagetronad.desktop
	 rm -rf $startdir/pkg/usr/share/applnk
	 rm $startdir/pkg/usr/bin/armagetronad-uninstall
	 mv $startdir/pkg/usr/bin/armagetronad $startdir/pkg/usr/bin/armagetronad_bin
	 printf "#!/bin/bash\n/usr/bin/armagetronad_bin --configdir /etc/armagetronad --datadir /usr/share/armagetronad" > $startdir/pkg/usr/bin/armagetronad
	 chmod +x $startdir/pkg/usr/bin/armagetronad
}

