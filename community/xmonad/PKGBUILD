# Maintainer: Vesa Kaihlavirta <vegai@iki.fi>
# Contributor: shild <shildv@gmail.com>
pkgname=xmonad
pkgver=0.8.1
pkgrel=1.3
pkgdesc="A lightweight X11 tiled window manager written in Haskell"
arch=(i686 x86_64)
url="http://xmonad.org/"
license=('BSD')
depends=('ghc' 'gmp' 'libxinerama' 'haskell-x11' sh)
install='xmonad.install'
#source=(http://hackage.haskell.org/packages/archive/$pkgname/$pkgver/$pkgname-$pkgver.tar.gz)
source=(http://code.haskell.org/~sjanssen/$pkgname-$pkgver.tar.gz)
md5sums=('03a8f0a420902d9eea3df1d8d62598c7')

build() {
  cd $startdir/src/$pkgname-$pkgver

  runhaskell Setup.lhs configure --ghc --prefix=/usr \
             --libsubdir=\$compiler/site-local/\$pkgid || return 1

  runhaskell Setup.lhs build || return 1

  runhaskell Setup.lhs register --gen-script
  runhaskell Setup.lhs unregister --gen-script
  
  install -D -m744 register.sh $startdir/pkg/usr/share/haskell/$pkgname/register.sh
  install -m744 unregister.sh $startdir/pkg/usr/share/haskell/$pkgname/unregister.sh
  runhaskell Setup.lhs copy --destdir=$startdir/pkg
  runhaskell util/GenerateManpage.hs

  install -D -m644 man/xmonad.1 $startdir/pkg/usr/share/man/man1/xmonad.1

  install -d -m755 $startdir/pkg/usr/share/xmonad
  install -m644 $startdir/examples/README $startdir/pkg/usr/share/xmonad/
  install -m644 $startdir/examples/*.hs $startdir/pkg/usr/share/xmonad/
  install -D LICENSE $startdir/pkg/usr/share/licenses/xmonad/LICENSE
}
