pkgname=libvdpau
pkgver=185.18.36
pkgrel=1
pkgdesc="NVIDIA vdpau library"
arch=('i686' 'x86_64')
[ "$CARCH" = "i686"   ] && ARCH=x86
[ "$CARCH" = "x86_64" ] && ARCH=x86_64
url="http://www.nvidia.com/"
conflicts=('nvidia-utils')
license=('custom')
source=("http://download.nvidia.com/XFree86/Linux-${ARCH}/${pkgver}/NVIDIA-Linux-${ARCH}-${pkgver}-pkg0.run")
md5sums=('cf40656600b8a587e82a801f05fa2d95')
[ "$CARCH" = "x86_64" ] && md5sums=('c9827059697001fa61518e56fdc24e93')

build() {
	cd $srcdir
	sh NVIDIA-Linux-${ARCH}-${pkgver}-pkg0.run --extract-only
	cd NVIDIA-Linux-${ARCH}-${pkgver}-pkg0/usr/

	mkdir -p $pkgdir/usr/include/vdpau
	mkdir -p $pkgdir/usr/lib
	install -m644 include/vdpau/vdpau*.h $pkgdir/usr/include/vdpau

	install lib/{libvdpau_trace,libvdpau_nvidia,libvdpau}.so.${pkgver} \
	$pkgdir/usr/lib/ || return 1

	cd $pkgdir/usr/lib/
	ln -s libvdpau.so.$pkgver libvdpau.so.1 || return 1
	ln -s libvdpau.so.$pkgver libvdpau.so || return 1

	install -D -m644 $srcdir/NVIDIA-Linux-${ARCH}-${pkgver}-pkg0/LICENSE $pkgdir/usr/share/licenses/$pkgname/license || return 1
}
