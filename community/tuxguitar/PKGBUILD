# $Id: PKGBUILD 82 2009-07-17 19:56:55Z aaron $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: |AhIoRoS| < ahioros@gmail.com >

pkgname=tuxguitar
pkgver=1.1
_pkgver=1.1
pkgrel=1
pkgdesc="multitrack guitar tablature editor and player"
arch=('i686' 'x86_64')
#url="http://www.herac.com.ar/contenidos/tuxguitar.html"
url="http://sourceforge.net/projects/tuxguitar"
license=('LGPL')
depends=('java-runtime')
makedepends=('unzip' 'zip')
install=tuxguitar.install
source=(http://switch.dl.sourceforge.net/tuxguitar/$pkgname-${_pkgver}-linux-x86.tar.gz \
	tuxguitar.desktop \
	tuxguitar.xml)
md5sums=('9efad98f94eca0a25b4519bed5613f25'
         'eea5247daa70ce6fc15e95b1080af486'
         '59ce4eb8dcc0d0dde81e6cf2820aa9b0')
[ "$CARCH" = "x86_64" ] && source=(http://downloads.sourceforge.net/tuxguitar/$pkgname-${_pkgver}-linux-x86_64.tar.gz \
	tuxguitar.desktop \
	tuxguitar.xml)
[ "$CARCH" = "x86_64" ] && md5sums=('b65319e22cd87ed8b4365c5ede593d26'
         'eea5247daa70ce6fc15e95b1080af486'
         '59ce4eb8dcc0d0dde81e6cf2820aa9b0')

build() {
  cd $startdir/src
  mkdir -p $startdir/pkg/usr/share && \
  mkdir -p $startdir/pkg/usr/bin
  if [ "$CARCH" = "i686" ]; then
    cp -r $pkgname-${_pkgver}-linux-x86 $startdir/pkg/usr/share/$pkgname || return 1
    cd $startdir/pkg/usr/share/$pkgname/lib
    unzip swt.jar libswt-*
    zip swt.jar -d libswt-*
    cd ..
  else
    cp -r $pkgname-${_pkgver}-linux-x86_64/ $startdir/pkg/usr/share/$pkgname || return 1
    cd $startdir/pkg/usr/share/$pkgname/lib
    unzip swt.jar libswt-*
    zip swt.jar -d libswt-*
    cd ..
  fi
	
  rm -fr doc && \
  cd $startdir/pkg/usr/bin

  cat >tuxguitar << EOF
#!/bin/sh
exec /usr/share/$pkgname/tuxguitar "\$1" "\$2" "\$3" "\$4" "\$5" "\$6" "\$7" "\$8" "\$9"
EOF

  chmod 755 tuxguitar && \
  install -D -m0644 $srcdir/tuxguitar.xml $pkgdir/usr/share/mime/packages/tuxguitar.xml && \
  install -D -m0644 $srcdir/tuxguitar.desktop $pkgdir/usr/share/applications/tuxguitar.desktop
}
