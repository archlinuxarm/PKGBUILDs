# Maintainer: Alexander Foremny <alexanderforemny@gmail.com>

pkgname=sysvinit
pkgver=2.86
pkgrel=3
pkgdesc="Linux System V Init"
arch=(arm)
license=('GPL')
groups=('base' 'small-base')
depends=('shadow' 'util-linux' 'coreutils' 'glibc' 'awk')
source=(ftp://ftp.cistron.nl/pub/people/miquels/$pkgname/$pkgname-$pkgver.tar.gz)
md5sums=('7d5d61c026122ab791ac04c8a84db967')

build() {
  cd $srcdir/sysvinit-$pkgver

  cp src/init.c src/init.c.backup
  sed 's/\(.*\)\(Sending processes\)\(.*\)/\1\2 started by init\3/' \
     src/init.c > tmp~
  mv tmp~ src/init.c
  mkdir -p $startdir/pkg/bin $startdir/pkg/sbin
  mkdir -p $startdir/pkg/usr/bin
  mkdir -p $startdir/pkg/usr/man/man5 $startdir/pkg/usr/man/man8
  mkdir -p $startdir/pkg/usr/man/man1 $startdir/pkg/usr/include
  make -C src || return 1
  make -C src MANDIR=/usr/man ROOT=$startdir/pkg install
}

