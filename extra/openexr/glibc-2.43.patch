diff --git a/src/lib/OpenEXRCore/internal_thread.h b/src/lib/OpenEXRCore/internal_thread.h
index 6c3c1032..e40321e1 100644
--- a/src/lib/OpenEXRCore/internal_thread.h
+++ b/src/lib/OpenEXRCore/internal_thread.h
@@ -10,6 +10,7 @@
 
 // Thread-safe single initiatization, using InitOnceExecuteOnce on Windows,
 // pthread_once elsewhere, or a simple variable if threading is completely disabled.
+#ifndef __once_flag_defined
 #if ILMTHREAD_THREADING_ENABLED
 #    ifdef _WIN32
 #        include <windows.h>
@@ -49,5 +50,5 @@ call_once (once_flag* flag, void (*func) (void))
     }
 }
 #endif
-
+#endif
 #endif /* OPENEXR_PRIVATE_THREAD_H */
