#Maintainer: Manuel Rotter <rotter.manuel@gmail.com>

pkgname=ubifs-utils
pkgver=20090903
pkgrel=1
pkgdesc="Tools for UBIFS"
arch=(arm)
license=('none')
url="http://www.linux-mtd.infradead.org/index.html"
depends=('zlib' 'lzo' 'util-linux-ng')
makedepends=('git')

_git="git://git.infradead.org/mtd-utils.git"

build() {
  cd $srcdir || return 1 #
  msg "Git Checkout..."
  git clone $_git || return 1
  msg "Finished Checkout"

  msg "Beginn Build..." 
  cd mtd-utils
  make # no "|| return 1" here, because some not fatal errors appear 
  cd mkfs.ubifs
  make || return 1
  cd ..

  msg "Installing..."
  install -D -m755 mkfs.ubifs/mkfs.ubifs $pkgdir/sbin/mkfs.ubifs 
  install -D -m755 ubi-utils/ubinfo $pkgdir/usr/bin/ubinfo
  install -D -m755 ubi-utils/ubiattach $pkgdir/usr/bin/ubiattach
  install -D -m755 ubi-utils/ubidetach $pkgdir/usr/bin/ubidetach
  install -D -m755 ubi-utils/ubimkvol $pkgdir/usr/bin/ubimkvol
  install -D -m755 ubi-utils/ubirmvol $pkgdir/usr/bin/ubirmvol
  install -D -m755 ubi-utils/ubiupdatevol $pkgdir/usr/bin/ubiupdatevol
  install -D -m755 ubi-utils/ubicrc32 $pkgdir/usr/bin/ubicrc32
  install -D -m755 ubi-utils/ubinize $pkgdir/usr/bin/ubinize
  install -D -m755 ubi-utils/ubiformat $pkgdir/usr/bin/ubiformat
  install -D -m755 ubi-utils/mtdinfo $pkgdir/usr/bin/mtdinfo
}
