# Maintainer: Alexander Foremny <alexanderforemny@gmail.com>

pkgname=pciutils
pkgver=3.1.2
pkgrel=1
pkgdesc="PCI bus configuration space access library and tools"
arch=(arm)
license=(GPL2)
url="http://mj.ucw.cz/pciutils.html"
makedepends=(wget)
depends=(glibc)
source=(ftp://ftp.kernel.org/pub/software/utils/${pkgname}/pciutils-$pkgver.tar.bz2)
md5sums=('46387fd7a18c33fbb5311fdb3ab9ea12')

build() {
  cd $srcdir/pciutils-$pkgver
  CFLAGS="$CFLAGS -fPIC -DPIC"
  sed -i -e "s/^OPT=.*/OPT=$CFLAGS/g" Makefile

  ./update-pciids.sh || return 1

  make ZLIB=no PREFIX=/usr SHAREDIR=/usr/share/hwdata all || return 1
  make PREFIX=$pkgdir/usr SHAREDIR=$pkgdir/usr/share/hwdata install || return 1

  install -Dm644 lib/libpci.a $pkgdir/usr/lib/libpci.a
  for i in config.h header.h pci.h types.h; do
    install -Dm644 lib/$i $pkgdir/usr/include/pci/$i
  done
}

# vim: set ft=sh ts=2 sw=2 et:
